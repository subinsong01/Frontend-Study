# 🚀 OAuth

🌱 **OAuth가 뭐죠?**
- 구글 로그인 기능을 떠올리면 간단하다 !
- 웹 서버에 구글 비밀번호를 제공하지 않아도, 구글 계정의 일부 접근 권한을 부여할 수 있다.
- ex) `SNS 간편 로그인 기능`을 제공 

**안전하지 않은 인증 방식 예시**
- 안전하지 않은 SNS 로그인 방식

  <img width="500" alt="스크린샷 2025-03-12 오후 11 11 22" src="https://github.com/user-attachments/assets/4b872bb1-2b2e-4d4b-80c9-fd7e0bcb14b0" />

🌱 **Access Token**
- 사용자가 설정한 권한에 대해서만 구글 정보에 접근할 수 있도록 하자
- 바로 **Access Token**을 사용하는 것

  <img width="441" alt="스크린샷 2025-03-12 오후 11 21 57" src="https://github.com/user-attachments/assets/a529d363-b20a-4b6a-baae-d1364d762689" />

🌱 **OAuth 핵심 요소**

  <img width="500" alt="스크린샷 2025-03-12 오후 11 22 57" src="https://github.com/user-attachments/assets/65927c3f-ef0a-46d6-9af4-3dabc3a8102a" />

🌱 **OAuth 동작**

  <img width="500" alt="스크린샷 2025-03-12 오후 11 25 55" src="https://github.com/user-attachments/assets/bd5c811e-09d0-4459-91f4-fe759ddcd57e" />


# 🚀 JWT

🌱 **JSON 형식?**

- JSON은 데이터를 주고받기 위해 사용하는 경량의 데이터 형식 중 하나다.
- JSON 형식에는 키와 값의 쌍으로 이루어진 데이터 객체를 사용한다.

  <img width="414" alt="스크린샷 2025-03-12 오후 11 29 09" src="https://github.com/user-attachments/assets/9c97dcf6-0929-43d9-b0a2-80a9c6cbec7e" />

🌱 **JWT이란?**

 - 인증에 필요한 정보를 암호화한 JSON 형식의 토큰이다.
 - JWT 토큰을 HTTP 헤더에 실어 서버가 클라이언트를 식별할 수 있도록 한다.
 - `Header`,`Payload`, `Signature`를 가진다
 - `Header`: 사용할 해시 알고리즘 등의 메타 정보를 포함
 - `Payload`: 키와 값 형식으로 이루어진 정보의 구성
  = 이 값을 서버로 전달한다
 - `Signature`: (헤더 + 페이로드 + 키) 정보를 `해싱하여` Client에게 함께 전달한다.

  <img width="456" alt="스크린샷 2025-03-12 오후 11 43 53" src="https://github.com/user-attachments/assets/cb1ea77e-9048-4b39-989f-6187055e43ce" />

  - 나중에 사용자는 자신이 받았던 `JWT 토큰`을 다시 서버에 전달
  - 서버는(헤더 + 페이로드 + 서버 내에 있는 키)를 해싱한 값이 사용자로부터 전달받은 것과 일치하는지 체크
  - 이 과정에서 서버가 가지고 있는 `비밀키`를 사용한다. 

[목적]
- 위조 방지
- 서버의 메모리 가용 이점(DB 조회 필요 x)

[장점]
- 세션 기반 인증 방식에 비해 서버가 DB에 세션 정보를 가지고 있을 필요가 없다
- 각 해시 값이 어떤 header와 Payload를 가지는지 일일이 서버 DB에서 저장할 이유가 없다
  - 서버에서 상태 정보를 저장하지 않아도 되므로, 무상태성이 유지된다.
- 토큰 기반이므로, 서로 다른 웹 서버에 대해서도 동작이 가능(웹 브라우저의 쿠키와 다른 점)

[단점]
- 세션에 비하여 토큰 자체의 데이터 길이가 길다
- 페이로드는 암호화되지 않으므로, 중요한 정보를 담기 적절하지 않을 수 있다.
- 토큰을 탈취당하는 경우 보안상의 문제 발생 가능

**실제 인증 예시**

  <img width="500" alt="스크린샷 2025-03-12 오후 11 50 07" src="https://github.com/user-attachments/assets/f9ae0c53-9ad3-4a60-a77c-17f561489d3e" />

-----

➡️ **엑세스 토큰 (Access Token)**

- 엑세스 토큰은 보통 짧은 유효 기간을 가지며, 사용자나 클라이언트가 서버에 접근할 때 권한을 부여받는 데 사용된다.
- 예를 들어, 사용자가 로그인하면 서버는 사용자에게 엑세스 토큰을 발급하여 그 후의 요청에서 이 토큰을 함께 보내면 인증되고 권한이 부여된다.
- 엑세스 토큰은 보통 짧은 시간(몇 분에서 몇 시간) 동안만 유효하며, 보안 상의 이유로 자주 갱신된다.

➡️ **리프레시 토큰 (Refresh Token)**

- 리프레시 토큰은 엑세스 토큰을 갱신하기 위해 사용된다.
- 보통 리프레시 토큰은 엑세스 토큰보다 더 긴 유효 기간을 가지며, 보안 상의 이유로 엑세스 토큰이 만료되었을 때 사용된다.
- 클라이언트는 만료된 엑세스 토큰을 사용하여 서버에 리프레시 토큰을 보내고, 서버는 유효한 리프레시 토큰이라면 새로운 엑세스 토큰을 발급해준다.

➡️ **요약**

- 엑세스 토큰은 짧은 유효 기간 동안 인증에 사용되고, 리프레시 토큰은 엑세스 토큰을 갱신하기 위한 장기적인 인증 도구이다.
